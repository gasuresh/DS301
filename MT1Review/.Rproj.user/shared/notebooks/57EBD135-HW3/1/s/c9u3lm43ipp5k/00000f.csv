"0","#2b."
"0","results_df <- data.frame(num_tests = numeric(), false_positives = numeric())"
"0",""
"0","for (p in seq(150, 800, by = 50)) {"
"0","  x <- matrix(rnorm(1000 * p), ncol = p)"
"0","  "
"0","  beta <- c(2, 3, 5, 4, 2, rep(0, p - 5))"
"0","  error <- rnorm(1000, 0, 1)"
"0","  y <- as.matrix(x) %*% beta + error"
"0","  "
"0","  data <- as.data.frame(cbind(y, x))"
"0","  "
"0","  fit <- lm(y ~ ., data = data)"
"0","  "
"0","  p_values <- suppressWarnings(coef(summary(fit))[, ""Pr(>|t|)""])"
"0","  "
"0","  num_false_positives <- sum(p_values < 0.05)"
"0","  "
"0","  results_df <- rbind(results_df, data.frame(num_tests = p, false_positives = num_false_positives))"
"0","}"
"0",""
"0","ggplot(results_df, aes(x = num_tests, y = false_positives)) +"
"0","  geom_line() +"
"0","  geom_point() +"
"0","  labs(title = ""Impact of Multiple Testing on False Positives"","
"0","       x = ""Num Tests"","
"0","       y = ""Num of False Positives"")"
