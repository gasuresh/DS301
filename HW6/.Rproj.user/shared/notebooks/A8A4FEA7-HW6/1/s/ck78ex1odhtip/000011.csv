"0","#3a."
"0",""
"0","p <- 17"
"0",""
"0","train_index <- sample(1:nrow(College), 0.9 * nrow(College))"
"0","train_data <- College[train_index, ]"
"0","test_data <- College[-train_index, ]"
"0",""
"0","regfit_fwd <- regsubsets(Apps~.,data=College,nvmax=p, nbest = 1, method=""forward"")"
"0","regfit_bwd <- regsubsets(Apps~.,data=College,nvmax=p, method=""backward"")"
"0",""
"0","forward_test_errors <- rep(NA, p)"
"0","backward_test_errors <- rep(NA, p)"
"0",""
"0","for (i in 1:p) {"
"0","  forward_test_mat <- model.matrix(Apps ~ ., data = test_data)"
"0","  "
"0","  coef_m <- coef(regfit_fwd, id = i)"
"0","  pred_test <- forward_test_mat[, names(coef_m)] %*% coef_m"
"0","  forward_test_errors[i] <- mean((pred_test - test_data$Apps)^2)"
"0","  "
"0","  backward_test_mat <- model.matrix(Apps ~ ., data = test_data)"
"0","  "
"0","  coef_m <- coef(regfit_bwd, id = i)"
"0","  pred_test <- backward_test_mat[, names(coef_m)] %*% coef_m"
"0","  backward_test_errors[i] <- mean((pred_test - test_data$Apps)^2)"
"0","}"
"0",""
"0","min_mse_forward <- which.min(forward_test_errors)"
"0",""
"0","min_mse_backward <- which.min(backward_test_errors)"
"0",""
"0",""
