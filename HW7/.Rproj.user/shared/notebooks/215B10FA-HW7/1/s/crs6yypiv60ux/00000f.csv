"0",""
"0","n = dim(Boston)[1]"
"0",""
"0","set.seed(10)"
"0","train_index = sample(1:n,n/2,rep=FALSE)"
"0",""
"0","train = Boston[train_index,]"
"0","test = Boston[-train_index,]"
"0",""
"0",""
"0","best_train = regsubsets(medv~.,data=train,nbest=1,nvmax=12)"
"0",""
"0","val_errors = rep(NA,8)"
"0","for(i in 1:8){"
"0","  test_mat = model.matrix(medv~.,data=test)"
"0","  "
"0","  coef_m = coef(best_train,id=i)"
"0",""
"0","  pred = test_mat[,names(coef_m)]%*%coef_m"
"0","  val_errors[i] = mean((test$medv-pred)^2)"
"0","}"
"0",""
"0","best_model_index <- which.min(val_errors)"
"0",""
"0","best_model_predictors <- names(coef(best_train, id = best_model_index))"
"0",""
"0","best_model_predictors <- best_model_predictors[!best_model_predictors %in% ""(Intercept)""]"
"0",""
"0","formula <- as.formula(paste(""medv ~"", paste(best_model_predictors, collapse = "" + "")))"
"0",""
"0","potential_final_model <- lm(formula, data = Boston)"
"0",""
