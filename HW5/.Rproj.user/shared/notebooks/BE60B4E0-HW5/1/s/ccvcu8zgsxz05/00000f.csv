"0","#1b."
"0",""
"0","train = subset(prostate,train==TRUE)[,1:9]"
"0","test = subset(prostate,train==FALSE)[,1:9]"
"0",""
"0","best_train = regsubsets(lpsa~.,data=train,nbest=1,nvmax=8)"
"0",""
"0","val_errors = rep(NA,8)"
"0","for(i in 1:8){"
"0","  test_mat = model.matrix(lpsa~.,data=test)"
"0","  "
"0","  coef_m = coef(best_train,id=i)"
"0",""
"0","  pred = test_mat[,names(coef_m)]%*%coef_m"
"0","  val_errors[i] = mean((test$lpsa-pred)^2)"
"0","}"
"0",""
"0","best_model_index <- which.min(val_errors)"
"0",""
"0","best_model_predictors <- names(coef(best_train, id = best_model_index))"
"0",""
"0","best_model_predictors <- best_model_predictors[!best_model_predictors %in% ""(Intercept)""]"
"0",""
"0","formula <- as.formula(paste(""lpsa ~"", paste(best_model_predictors, collapse = "" + "")))"
"0",""
"0","final_model <- lm(formula, data = prostate)"
"0",""
